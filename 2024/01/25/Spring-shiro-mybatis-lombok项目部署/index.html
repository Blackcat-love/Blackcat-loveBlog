<!DOCTYPE html><html class="appearance-auto" lang="zh-CN"><head><meta charset="UTF-8"><title>Spring+shiro+mybatis+lombok项目部署</title><meta name="description" content="编程"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/Blackcat-loveBlog/images/favicon.ico"><link rel="stylesheet" href="/Blackcat-loveBlog/style/common/bulma.css"><link rel="stylesheet" href="/Blackcat-loveBlog/style/base.css"><link rel="stylesheet" href="/Blackcat-loveBlog/style/common/helper.css"><script src="/Blackcat-loveBlog/js/common.js"></script><link rel="stylesheet" href="/Blackcat-loveBlog/style/post.css"><link rel="stylesheet" href="/Blackcat-loveBlog/style/themes/highlight-theme-light.css"><link rel="stylesheet" href="/Blackcat-loveBlog/style/common/jquery.fancybox.min.css"><script src="/Blackcat-loveBlog/js/highlight.pack.js"></script><meta name="description" content="项目介绍本项目是maven项目
数据库mysql
前端html+jquery+md5+wangEditor+cancas 框架:bootstrap
后端spring+mybatis+shiro+lombok
笔记配套项目:
配置文件spring:
  datasource:
    url: jdbc:mysql://localhost:3306/finance?useUnicode=true&amp;amp;characterEncoding=utf8&amp;amp;useSSL=false&amp;amp;serverTimezone=UTC&amp;amp;zeroDateTimeBehavior=convertToNull
    username: root
    password: 123456
    driver-cl.."><meta name="generator" content="Hexo 7.2.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/Blackcat-loveBlog/">天明's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Spring+shiro+mybatis+lombok项目部署</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">点击返回顶部</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/Blackcat-loveBlog/">首页</a></h3><h3 class="is-inline-block"><a href="/Blackcat-loveBlog/about/about">关于</a></h3><h3 class="is-inline-block"><a href="/Blackcat-loveBlog/archives">归档</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/Blackcat-loveBlog/">首页</a></h3><h3 class="is-inline-block"><a href="/Blackcat-loveBlog/about/about">关于</a></h3><h3 class="is-inline-block"><a href="/Blackcat-loveBlog/archives">归档</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D"><span class="toc-text">项目介绍</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-text">配置文件</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E7%B1%BBJsonUtils"><span class="toc-text">返回类JsonUtils</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Config"><span class="toc-text">Config</span></a></li></ol></div><div class="column is-9"><header class="my-4"><a href="/Blackcat-loveBlog/tags/Spring"><i class="tag post-item-tag">Spring</i></a><a href="/Blackcat-loveBlog/tags/shiro"><i class="tag post-item-tag">shiro</i></a><a href="/Blackcat-loveBlog/tags/mybatis"><i class="tag post-item-tag">mybatis</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">Spring+shiro+mybatis+lombok项目部署</h1><time class="has-text-grey" datetime="2024-01-25T12:07:51.000Z">2024-01-25</time><article class="mt-2 post-content"><h1 id="项目介绍"><a href="#项目介绍" class="headerlink" title="项目介绍"></a>项目介绍</h1><p>本项目是maven项目</p>
<p>数据库mysql</p>
<p>前端html+jquery+md5+wangEditor+cancas 框架:bootstrap</p>
<p>后端spring+mybatis+shiro+lombok</p>
<p>笔记配套项目:</p>
<h1 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h1><pre><code class="highlight yaml"><span class="attr">spring:</span>
  <span class="attr">datasource:</span>
    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/finance?useUnicode=true&amp;characterEncoding=utf8&amp;useSSL=false&amp;serverTimezone=UTC&amp;zeroDateTimeBehavior=convertToNull</span>
    <span class="attr">username:</span> <span class="string">root</span>
    <span class="attr">password:</span> <span class="number">123456</span>
    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span>
    <span class="attr">type:</span> <span class="string">com.alibaba.druid.pool.DruidDataSource</span>
    <span class="attr">druid:</span>
      <span class="attr">initial-size:</span> <span class="number">5</span>
      <span class="attr">min-idle:</span> <span class="number">5</span>
      <span class="attr">max-active:</span> <span class="number">20</span>
      <span class="attr">max-wait:</span> <span class="number">60000</span>
      <span class="attr">time-between-eviction-runs-millis:</span> <span class="number">60000</span>
      <span class="attr">min-evictable-idle-time-millis:</span> <span class="number">300000</span>
      <span class="attr">validation-query:</span> <span class="string">SELECT</span> <span class="number">1</span> <span class="string">FROM</span> <span class="string">DUAL</span>
      <span class="attr">test-while-idle:</span> <span class="literal">true</span>
      <span class="attr">test-on-borrow:</span> <span class="literal">false</span>
      <span class="attr">test-on-return:</span> <span class="literal">false</span>
      <span class="attr">pool-prepared-statements:</span> <span class="literal">true</span>
      <span class="attr">max-pool-prepared-statement-per-connection-size:</span> <span class="number">20</span>
      <span class="attr">filters:</span> <span class="string">stat,wall</span>
      <span class="attr">use-global-data-source-stat:</span> <span class="literal">true</span>
      <span class="attr">connect-properties:</span> <span class="string">druid.stat.mergeSql=true;druid.stat.slowSqlMillis=5000</span>
  <span class="attr">web:</span>
    <span class="attr">resources:</span>
      <span class="attr">static-locations:</span> <span class="string">classpath:/static/</span>

<span class="attr">mybatis:</span>
  <span class="attr">mapper-locations:</span> <span class="string">classpath:mapper/*.xml</span>
  <span class="attr">type-aliases-package:</span> <span class="string">com.crazy.finance.bean</span>
  <span class="attr">configuration:</span>
    <span class="attr">map-underscore-to-camel-case:</span> <span class="literal">true</span> <span class="comment">#将下换线转成驼峰式</span>
<span class="comment">#  configuration:</span>
<span class="comment">#   log-impl: org.apache.ibatis.logging.stdout.StdOutImpl</span>
<span class="attr">server:</span>
  <span class="attr">port:</span> <span class="number">8099</span></code></pre>

<h1 id="返回类JsonUtils"><a href="#返回类JsonUtils" class="headerlink" title="返回类JsonUtils"></a>返回类JsonUtils</h1><p><strong>在tuils里的JsonUtils类</strong></p>
<pre><code class="highlight java"><span class="keyword">package</span> com.example.finance.utils;

<span class="keyword">import</span> lombok.Data;

<span class="keyword">import</span> java.util.HashMap;
<span class="keyword">import</span> java.util.Map;

<span class="comment">/**</span>
<span class="comment"> * 通用的返回类（封装json数据）</span>
<span class="comment"> *</span>
<span class="comment"> */</span>
<span class="meta">@Data</span>
<span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">JsonUtils</span> {
    <span class="comment">// 状态码 100-成功 200-失败</span>
    <span class="keyword">private</span> <span class="type">int</span> code;
    <span class="comment">// 提示信息</span>
    <span class="keyword">private</span> String msg;

    <span class="comment">// 用户要返回给浏览器的数据</span>
    <span class="keyword">private</span> Map&lt;String, Object&gt; extend = <span class="keyword">new</span> <span class="title class_">HashMap</span>();
    <span class="comment">/**</span>
<span class="comment">     * 处理成功</span>
<span class="comment">     *</span>
<span class="comment">     * <span class="doctag">@return</span></span>
<span class="comment">     */</span>
    <span class="keyword">public</span> <span class="keyword">static</span> JsonUtils <span class="title function_">success</span><span class="params">()</span> {
        <span class="type">JsonUtils</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JsonUtils</span>();
        result.setCode(<span class="number">100</span>);
        result.setMsg(<span class="string">"处理成功！"</span>);
        <span class="keyword">return</span> result;
    }

    <span class="comment">/**</span>
<span class="comment">     * 处理失败</span>
<span class="comment">     *</span>
<span class="comment">     * <span class="doctag">@return</span></span>
<span class="comment">     */</span>
    <span class="keyword">public</span> <span class="keyword">static</span> JsonUtils <span class="title function_">fail</span><span class="params">()</span> {
        <span class="type">JsonUtils</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JsonUtils</span>();
        result.setCode(<span class="number">200</span>);
        result.setMsg(<span class="string">"处理失败！"</span>);
        <span class="keyword">return</span> result;
    }

    <span class="keyword">public</span> <span class="keyword">static</span> JsonUtils <span class="title function_">failPs</span><span class="params">()</span> {
        <span class="type">JsonUtils</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JsonUtils</span>();
        result.setCode(<span class="number">300</span>);
        result.setMsg(<span class="string">"处理失败！"</span>);
        <span class="keyword">return</span> result;
    }
    <span class="keyword">public</span> <span class="keyword">static</span> JsonUtils <span class="title function_">failEx</span><span class="params">()</span> {
        <span class="type">JsonUtils</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JsonUtils</span>();
        result.setCode(<span class="number">400</span>);
        result.setMsg(<span class="string">"处理失败！"</span>);
        <span class="keyword">return</span> result;
    }
    <span class="keyword">public</span> <span class="keyword">static</span> JsonUtils <span class="title function_">failNu</span><span class="params">()</span> {
        <span class="type">JsonUtils</span> <span class="variable">result</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JsonUtils</span>();
        result.setCode(<span class="number">500</span>);
        result.setMsg(<span class="string">"处理失败！"</span>);
        <span class="keyword">return</span> result;
    }

    <span class="comment">/**</span>
<span class="comment">     * 添加要返回的json数据</span>
<span class="comment">     *</span>
<span class="comment">     * <span class="doctag">@param</span> key</span>
<span class="comment">     * <span class="doctag">@param</span> value</span>
<span class="comment">     * <span class="doctag">@return</span></span>
<span class="comment">     */</span>
    <span class="keyword">public</span> JsonUtils <span class="title function_">add</span><span class="params">(String key, Object value)</span> {
        <span class="built_in">this</span>.getExtend().put(key, value);
        <span class="keyword">return</span> <span class="built_in">this</span>;
    }
}
</code></pre>

<h1 id="Config"><a href="#Config" class="headerlink" title="Config"></a>Config</h1><p>一些配置类</p>
<p>分别是ShiroConfig类</p>
<p>用来自动实现权限分配</p>
<pre><code class="highlight java"><span class="keyword">package</span> com.example.finance.config.shiro;

<span class="keyword">import</span> at.pollux.thymeleaf.shiro.dialect.ShiroDialect;
<span class="keyword">import</span> lombok.extern.slf4j.Slf4j;
<span class="keyword">import</span> org.apache.shiro.spring.web.ShiroFilterFactoryBean;
<span class="keyword">import</span> org.apache.shiro.web.mgt.DefaultWebSecurityManager;
<span class="keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;
<span class="keyword">import</span> org.springframework.context.annotation.Bean;
<span class="keyword">import</span> org.springframework.context.annotation.Configuration;


<span class="keyword">import</span> java.util.LinkedHashMap;
<span class="keyword">import</span> java.util.Map;

<span class="meta">@Slf4j</span>
<span class="meta">@Configuration</span>
<span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ShiroConfig</span> {

   <span class="meta">@Bean</span>
   <span class="keyword">public</span> ShiroFilterFactoryBean <span class="title function_">getShiroFilterFactoryBean</span><span class="params">(<span class="meta">@Qualifier("securityManager")</span> DefaultWebSecurityManager securityManager)</span>{
       <span class="type">ShiroFilterFactoryBean</span> <span class="variable">bean</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ShiroFilterFactoryBean</span>();
       bean.setSecurityManager(securityManager);
       <span class="comment">//一定要用LinkedHashMap。不然会导致规则混乱</span>
       Map&lt;String, String&gt; filterMap = <span class="keyword">new</span> <span class="title class_">LinkedHashMap</span>();
        <span class="comment">// log.info("ShiroFilterFactoryBean-------------------------------");</span>
       <span class="comment">//添加shiro的内置过滤器</span>
        <span class="comment">/*</span>
<span class="comment">            anon: 无需认证就可访问</span>
<span class="comment">            authc：必须认证才能访问</span>
<span class="comment">            user：必须拥有记住我功能才能访问</span>
<span class="comment">            perms: 拥有对某个资源的权限才能访问</span>
<span class="comment">            role:拥有某个角色权限才能访问</span>
<span class="comment">       */</span>
<span class="comment">//     添加授权</span>
      <span class="comment">// filterMap.put("/user/**", "roles[user]");</span>
      <span class="comment">// filterMap.put("/admin/**", "roles[admin]");</span>

<span class="comment">//     过滤请求</span>
       filterMap.put(<span class="string">"/error/**"</span>, <span class="string">"anon"</span>);
       filterMap.put(<span class="string">"/"</span>, <span class="string">"anon"</span>);
       filterMap.put(<span class="string">"/index.html"</span>, <span class="string">"anon"</span>);
       filterMap.put(<span class="string">"/toregister.html"</span>, <span class="string">"anon"</span>);
       filterMap.put(<span class="string">"/login/**"</span>, <span class="string">"anon"</span>);
       filterMap.put(<span class="string">"/asserts/**"</span>, <span class="string">"anon"</span>);
       filterMap.put(<span class="string">"/bootstrap/**"</span>, <span class="string">"anon"</span>);
       filterMap.put(<span class="string">"/images/**"</span>, <span class="string">"anon"</span>);
       filterMap.put(<span class="string">"/lyear/**"</span>, <span class="string">"anon"</span>);
       filterMap.put(<span class="string">"/js/**"</span>, <span class="string">"anon"</span>);
<span class="comment">//     对所有请求认证</span>
<span class="comment">//     主要这行代码必须放在所有权限设置的最后，不然会导致所有 url 都被拦截</span>
       filterMap.put(<span class="string">"/**"</span>, <span class="string">"authc"</span>);

<span class="comment">//      设置登出</span>
<span class="comment">//     filterMap.put("/logout", "logout");</span>

       bean.setFilterChainDefinitionMap(filterMap);
<span class="comment">//     设置登录请求（认证界面）</span>
       bean.setLoginUrl(<span class="string">"/"</span>);
<span class="comment">//     设置未授权页面</span>
<span class="comment">//     bean.setUnauthorizedUrl("/noauth");</span>

       <span class="keyword">return</span> bean;
   }

    <span class="meta">@Bean("securityManager")</span>
    <span class="keyword">public</span> DefaultWebSecurityManager <span class="title function_">getDefaultWebSecurityManager</span><span class="params">(<span class="meta">@Qualifier("userRealm")</span> UserRealm userRealm)</span> {
        <span class="type">DefaultWebSecurityManager</span> <span class="variable">securityManager</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DefaultWebSecurityManager</span>();

        securityManager.setRealm(userRealm);
        <span class="keyword">return</span> securityManager;
    }

    <span class="meta">@Bean("userRealm")</span>
    <span class="keyword">public</span> UserRealm <span class="title function_">getUserRealm</span><span class="params">()</span> {
        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">UserRealm</span>();
    }

    <span class="comment">//整合thymeleaf</span>
    <span class="meta">@Bean</span>
    <span class="keyword">public</span> ShiroDialect <span class="title function_">getShiroDialect</span><span class="params">()</span> {
        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ShiroDialect</span>();
    }

}
</code></pre>

</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/Blackcat-loveBlog/2024/02/04/obs%E6%8F%92%E4%BB%B6/" title="obs插件"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">上一页: obs插件</span></a><a class="button is-default" href="/Blackcat-loveBlog/2024/01/25/%E8%87%AA%E5%8A%A8%E5%8C%96python%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="自动化python学习笔记"><span class="has-text-weight-semibold">下一页: 自动化python学习笔记</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/Blackcat-love"><i class="iconfont icon-github"></i></a><!-- Ins--><!-- RSS--><!-- 知乎--><!-- 领英--><!-- 脸书--></section><p><span>Copyright ©</span><span> 天明 2024</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/Blackcat-loveBlog/js/jquery-3.6.1.min.js"></script><script src="/Blackcat-loveBlog/js/jquery-fancybox.min.js"></script><script src="/Blackcat-loveBlog/js/img_zoom.js"></script><script src="/Blackcat-loveBlog/js/post.js"></script><!-- hexo injector body_end start --><script data-pjax src="https://registry.npmmirror.com/oh-my-live2d/latest/files"></script><script>const oml2d = OML2D.loadOml2d({libraryUrls:{"complete":"https://registry.npmmirror.com/oh-my-live2d/latest/files/lib/complete.js","cubism2":"https://registry.npmmirror.com/oh-my-live2d/latest/files/lib/cubism2.js","cubism5":"https://registry.npmmirror.com/oh-my-live2d/latest/files/lib/cubism5.js"},mobileDisplay:true,models:[{"path":"/Blackcat-loveBlog/live2d/波奇酱2.0/波奇酱2.0.model3.json","mobilePosition":[0,0],"mobileScale":0.1,"mobileStageStyle":{"width":180,"height":250},"motionPreloadStrategy":"IDLE","position":[-100,-100],"scale":0.15,"stageStyle":{"width":250,"height":250}},{"path":"/Blackcat-loveBlog/live2d/liang_vts/liang.model3.json","scale":0.12,"position":[0,60],"stageStyle":{"width":250},"mobileScale":0.1,"mobilePosition":[0,0],"mobileStageStyle":{"width":180}}],parentElement:document.body,primaryColor:"var(--btn-bg)",sayHello:false,tips:{style: {"width":230,"height":120,"left":"calc(50% - 20px)","top":"-100px"},mobileStyle: {"width":180,"height":80,"left":"calc(50% - 30px)","top":"-100px"},idleTips:{interval:15000,message:function(){
  return axios.get('https://v1.hitokoto.cn?c=i')
    .then(function (response) {
      return response.data.hitokoto ;
    })
    .catch(function (error) {
      console.error(error);
    });
}
}}});</script><!-- hexo injector body_end end --></body></html>