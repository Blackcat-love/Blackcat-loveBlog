<!DOCTYPE html><html class="appearance-auto" lang="zh-CN"><head><meta charset="UTF-8"><title>sqlserver基础语句</title><meta name="description" content="编程"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/images/favicon.ico"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><link rel="stylesheet" href="/style/common/jquery.fancybox.min.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="select * from Demo

--获取系统时间
select GETDATE()

--读取表里的生日
select birthady from Demo

--计算年龄
select DATEDIFF(yy,'2003-06-01',GETDATE())

--读取表里的生日                      -- as 别名
 select DATEDIFF(yy,birthady,GETDATE()) as '计算结果' from Demo;  --如果没有from 表格 那么就无法定位到 名为 birthady的列 所以就会失败
-- 查询 [DATAEIFF() 函数返回两个日期的间隔 里面是 birthady日期 和 GETDATE 当前日期获取] 来自 Demo 表格

--.."><meta name="generator" content="Hexo 5.1.1">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">天明's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">sqlserver基础语句</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">点击返回顶部</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">首页</a></h3><h3 class="is-inline-block"><a href="/about/about">关于</a></h3><h3 class="is-inline-block"><a href="/archives">归档</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile is-hidden"></div><div class="column is-9"><header class="my-4"><a href="/tags/sql"><i class="tag post-item-tag">sql</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">sqlserver基础语句</h1><time class="has-text-grey" datetime="2020-09-03T11:22:40.000Z">2020-09-03</time><article class="mt-2 post-content"><pre><code class="sql">select * from Demo

--获取系统时间
select GETDATE()

--读取表里的生日
select birthady from Demo

--计算年龄
select DATEDIFF(yy,'2003-06-01',GETDATE())

--读取表里的生日                      -- as 别名
 select DATEDIFF(yy,birthady,GETDATE()) as '计算结果' from Demo;  --如果没有from 表格 那么就无法定位到 名为 birthady的列 所以就会失败
-- 查询 [DATAEIFF() 函数返回两个日期的间隔 里面是 birthady日期 和 GETDATE 当前日期获取] 来自 Demo 表格

--全部查询
select * from student

--条件查询

select name,age from student
where age&gt;30
order by age desc

--起别名
                 --注意，as 可写可不写
select name as '姓名' ,age as '年龄'  from student
where age&gt;30
order by age desc

--加top
select top 2  name as '姓名' ,age as '年龄'  from student
where age&gt;30
order by age desc

--加常量列
select top 2  name as '姓名' ,age as '年龄' , '你好' as '还好'  from student
where age&gt;30
order by age desc

--加百分比查询 top
select top 50 percent  name as '姓名' ,age as '年龄' , '你好' as '还好'  from student
where age&gt;30
order by age desc

--加百分比查询 加减操作
select top 50 percent  name as '姓名' ,age + 50 as '年龄' , '你好' as '还好'  from student
where age&gt;30
order by age desc

-- is NULL 和 为空不一样
-- 查询条件为 值为NULL 或者 值为'空'
select * from student
where phone is null or phone = ''


-- 检索 所有 学生表 as 别名Stu
select * from Student as Stu
inner join score as Sco -- inner join 关联 成绩表 别名 as Sco
on Stu.Sid = Sco.id -- 关联条件 学生表的 Sid 和 成绩表的 id 进行关联 查询

--挑选结果
select Stu.name,Sco.name,Sco.age,Sco.sex,Sco.id from Student as Stu
inner join score as Sco
on Stu.Sid = Sco.id 
--还可以写条件
where Sco.age=20

--------------
select * from score as Sco -- 查询
left join Student as Stu   -- 左边查询 没有显示NULL
on Stu.Sid = Sco.id 
--右链接 取反

--求和
select SUM(age) as '学生年龄和' from Student

--最大值 最小值
select SUM(age) as '学生年龄和' from Student
select avg(age) as '学生平均值' from Student
select max(age) as '男同学的最大年龄' 
from score where sex = '男'

--个数
select COUNT(*) as '男同学个数'  -- 一般来说括号里是 * 或者是 1
from score where sex = '男'

select max(age) as '男同学的最大年龄' 
from score where sex = '男'
----------------
select count(*) as '女同学的个数' 
from score where sex = '女'
----------------
select distinct(age) as '男同学的年龄都有那些' 
from score where sex = '男'

--聚合函数 分组
select  sex,COUNT(*) as '个数' from score -- group by 为分组判断 他会把不一样的分组判断 计算个数出来 其中 group by 只负责分组 而 count负责计算
group by sex

--where  是分组前的条件
--having 是分组后的条件
select  sex,COUNT(*) as '个数' from score
where age &gt; 1 -- 为前
group by sex
having COUNT(*) &lt; 1 -- 为后
--运行结果 满足此条件为 0

select * from Usersinfo
where LoginName in ('lilei@163.com')

--使用连接查询登录名为 lilei@163.com 的用户所记笔记的笔记标题 内容和用户姓名
select Note.Title,Note.Content,Usr.UserName from Usersinfo as Usr
inner join NoteInfo as Note
on Usr.UserId = Note.NoteId 
where Usr.LoginName = 'lilei@163.com'

--使用聚合函数查询登录名为 zhangtao@163.com 的用户且笔记分类名称是 工作 的笔记记录数
--聚合函数 分组
select  CategoryName,COUNT(*) as '个数' from NoteCategory -- group by 为分组判断 他会把不一样的分组判断 计算个数出来 其中 group by 只负责分组 而 count负责计算
group by CategoryName

--使用模糊查询 查询登录名为 lilei.163.com 的用户 且笔记标题里包含 邮件 的笔记标题和内容
select * from Usersinfo
where LoginName like '%lilei.163.com%'

--按照创建时间降序排序 查询登录名为 lilei@163.com 的前10条笔记的标题和内容


--查询所有用户的姓名 登录名 笔记标题和笔记内容


--查询记录笔记数大于 1 的用户姓名 登录名和性别

use school
select * from student;
 --添加语句
 insert into student values(2,3,4,5,6,7);
 --添加语句
 insert into student (name,sex,age)
 values
 (4,5,6)
 --运行结果失败，是因为不允许为NULL 不然则可以
 
 --多行插入
 insert into student values
 (4,5,6,7,8), --如果报红要加一个逗号 
 (5,6,7,8,9)

 insert into Patient (password,BirthDate,Gender,PatientName,PhoneNum,Email,IndentityNum,Address)
 values(123456,'1985-06-07','女','夏颖',13800000001,'ying.xia@qq.com',110000198506071100,'厦门市'),
 (234567,'1985-06-08','男','李政',1380000002,'lizheng@163.com',210000198506082100,'长春市')
 
select * from Patient;
 
 --更新语句
 UPDATE Patient set Password='11111'
 
 --删除语句  范围是 id = 1;
 delete from Patient where Patient=1;
 --直接删除全部
 delete from Patient 
 --但是序号都在 
 
 --用清除会连序号全部彻底删除
 
 --去重 加入 distinct后 sex展示相同的只会显示一次
 select distinct sex from Student
</code></pre>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2021/12/11/JS%20/" title="JavaScript学习笔记"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">上一页: JavaScript学习笔记</span></a><a class="button is-default" href="/2019/10/18/Dos%E6%95%B4%E7%90%86/" title="Dos操作指令"><span class="has-text-weight-semibold">下一页: Dos操作指令</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/Blackcat-love"><i class="iconfont icon-github"></i></a><!-- Ins--><!-- RSS--><!-- 知乎--><!-- 领英--><!-- 脸书--></section><p><span>Copyright ©</span><span> 天明 2024</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" target="_blank" rel="noopener" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" target="_blank" rel="noopener" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/jquery-3.6.1.min.js"></script><script src="/js/jquery-fancybox.min.js"></script><script src="/js/img_zoom.js"></script><script src="/js/post.js"></script></body></html>